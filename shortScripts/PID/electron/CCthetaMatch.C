void CCthetaMatch(int sector = 1)
{
gStyle->SetOptStat(0);

TFile *fD = new TFile("/home/kjgroup/mysidis/histos/pid.data.s1.n12114.root");
TFile *fMC = new TFile("/home/kjgroup/mysidis/histos/pid.MonteCarlo_v12.s1.n32255.root");

TH2F *hD[2][6];
TH2F *hMC[2][6];

const int Nstrictnesses = 5;
float Nsigma[Nstrictnesses] = {5.0, 4.5, 4.0, 3.5, 3.0};

float CCseg_mu_e[2][6][18] = {{{9.83512,10.8576,12.3534,14.0989,16.0519,17.9409,19.9201,21.9689,24.0949,26.1043,28.2876,30.4488,32.8855,35.4499,38.0482,40.7007,42.8706,44.3719},{9.8311,10.7617,12.2906,14.0424,16.0356,17.9779,19.9756,21.9923,24.0451,26.0393,28.2977,30.4821,32.9376,35.5373,38.2148,40.8042,42.967,44.3765},{9.85194,10.9203,12.4324,14.1801,16.1147,18.0023,19.9695,22.023,24.1619,26.193,28.417,30.5605,33.0145,35.5573,38.1174,40.7452,42.9429,44.434},{9.83662,10.8673,12.3797,14.101,16.0623,18.0108,20.0157,22.0435,24.1044,26.0546,28.2541,30.4766,32.9183,35.5939,38.2295,40.8019,42.9187,44.4056},{9.84106,10.8594,12.4104,14.138,16.0514,17.9305,19.8963,21.9696,24.0971,26.1388,28.3623,30.5144,32.9263,35.4355,38.0802,40.7846,42.9397,44.4507},{9.83076,10.6723,12.3371,14.1462,16.0434,17.9909,19.9782,21.9891,24.0858,26.1182,28.3126,30.4825,32.9697,35.5284,38.1669,40.8796,42.9852,44.3872}},{{9.34037,10.7594,12.7647,14.736,16.6515,18.7595,20.8056,22.8826,24.8338,26.773,28.798,31.1131,33.6118,36.6606,39.3775,41.8706,43.7937,43.5108},{9.39088,10.7841,12.5898,14.4987,16.4176,18.5062,20.6564,22.7226,24.7938,26.8372,28.8277,31.009,33.685,36.3016,39.3323,41.7001,43.5399,43.361},{9.28666,10.6877,12.6832,14.5967,16.5731,18.6448,20.6933,22.8032,24.8087,26.7244,28.7212,30.912,33.8709,36.6297,39.3059,41.7144,43.6106,44.0706},{9.03196,10.7856,12.8366,14.7598,16.6495,18.6836,20.7819,22.9004,24.8551,26.7158,28.6873,30.9702,33.4061,36.4594,39.1286,41.7975,43.8097,43.9377},{9.96753,10.6624,13.427,14.113,16.7449,18.7448,20.8307,23.0411,25.1834,27.1859,29.5993,31.5893,34.1584,36.6028,39.3136,41.8122,43.8056,43.3776},{9.70209,10.8024,12.7174,14.7,16.5544,18.589,20.5457,22.7765,24.6167,26.7398,28.7212,31.0336,33.3699,36.3344,39.5463,42.0496,43.7081,43.539}}};
float CCseg_sigma_e[2][6][18] = {{{0.580766,0.906869,0.991186,1.04888,0.97877,0.971421,0.999088,1.01544,1.06258,1.04797,1.10965,1.14557,1.17488,1.24825,1.28958,1.31761,1.1265,0.781513},{0.581483,0.903044,0.985741,1.04766,1.00184,0.986884,0.988112,0.998394,1.03887,1.04899,1.14625,1.15233,1.21354,1.28391,1.26709,1.3108,1.11322,0.723599},{0.590405,0.910468,0.99884,1.04504,0.988364,0.975463,1.00485,1.02654,1.08591,1.05942,1.12799,1.16096,1.17887,1.23828,1.29489,1.35788,1.18078,0.781653},{0.585818,0.907593,0.996763,1.03009,1.00414,1.00494,0.993469,1.01078,1.03484,1.02931,1.13705,1.15768,1.21619,1.28737,1.26566,1.30526,1.09945,0.774484},{0.586356,0.917402,1.0065,1.03095,0.975623,0.967723,0.992303,1.03544,1.06634,1.05213,1.12664,1.15316,1.16242,1.25045,1.3042,1.34331,1.12554,0.774596},{0.564845,0.867598,1.05251,1.00669,1.00833,0.992138,0.987713,1.0045,1.05828,1.05632,1.12619,1.16169,1.1983,1.26686,1.28113,1.30279,1.0695,0.704273}},{{0.943102,1.07199,1.18821,1.12258,1.10298,1.12796,1.24707,1.13558,1.10508,1.2582,1.40941,1.56726,1.76608,1.67508,1.60719,1.54769,1.18419,1.93474},{0.989609,1.16341,1.25064,1.02821,1.06759,1.24962,1.21702,1.30632,1.34487,1.29768,1.49358,1.57154,1.75414,1.97463,1.65982,1.62968,1.32612,1.98807},{0.910813,1.11557,1.20224,1.14018,1.1002,1.1347,1.17672,1.27507,1.20364,1.20651,1.39737,1.59964,1.7779,1.81327,1.72549,1.68432,1.2769,1.64381},{0.793913,1.1091,1.19104,1.0315,0.982395,1.06427,1.14631,1.10191,1.1023,1.1032,1.23496,1.49888,1.65003,1.53575,1.61459,1.54627,1.20327,1.71327},{1.09804,1.42595,1.36764,1.94174,1.09743,1.14992,1.23973,1.25774,1.39793,1.35578,1.56965,1.6683,1.60559,1.71278,1.6854,1.7311,1.29476,1.99692},{1.01493,1.07025,1.25704,1.15883,1.06627,1.09337,1.17806,1.13053,1.15602,1.24616,1.36269,1.45487,1.6465,1.9598,1.73498,1.66839,1.5,2.04473}}};

float upperpts[2][6][Nstrictnesses][18];
float lowerpts[2][6][Nstrictnesses][18];
float segN[18];

TGraph *uppergraph[2][6][Nstrictnesses];
TGraph *lowergraph[2][6][Nstrictnesses];

for(int t = 0; t < 2; t++)
{
for(int s = 0; s < 6; s++)
{

for(int k = 0; k < 18; k++)
{
for(int st = 0; st < Nstrictnesses; st++)
{
upperpts[t][s][st][k] = CCseg_mu_e[t][s][k] + Nsigma[st]*CCseg_sigma_e[t][s][k];
lowerpts[t][s][st][k] = CCseg_mu_e[t][s][k] - Nsigma[st]*CCseg_sigma_e[t][s][k];
segN[k] = k + 1.5;
}
}

for(int st = 0; st < Nstrictnesses; st++)
{
uppergraph[t][s][st] = new TGraph(18, segN, upperpts[t][s][st]);
uppergraph[t][s][st]->SetMarkerStyle(34);
lowergraph[t][s][st] = new TGraph(18, segN, lowerpts[t][s][st]);
lowergraph[t][s][st]->SetMarkerStyle(34);
}

}}

TCanvas *can = new TCanvas("can", "can", 1500, 60, 1600, 1000);
can->Divide(6, 4, 0.00001, 0.00001);

for(int c = 0; c < 2; c++)
{
for(int s = 0; s < 6; s++)
{
can->cd(c*6 + s + 1);
hD[c][s] = (TH2F*) fD->Get(Form("eIDplots/thetaCCVcc_seg_e_hist_c%i_s%i", c, s+1));
hD[c][s]->GetXaxis()->SetTitle("CC segm.");
hD[c][s]->GetYaxis()->SetTitle("thetaCC (deg.)");
hD[c][s]->Draw("colz");
if(c==1)
{
for(int st = 0; st < Nstrictnesses; st++)
{
uppergraph[1][s][st]->Draw("P");
lowergraph[1][s][st]->Draw("P");
}
}

can->cd(12 + c*6 + s + 1);
hMC[c][s] = (TH2F*) fMC->Get(Form("eIDplots/thetaCCVcc_seg_e_hist_c%i_s%i", c, s+1));
hMC[c][s]->GetXaxis()->SetTitle("CC segm.");
hMC[c][s]->GetYaxis()->SetTitle("thetaCC (deg.)");
hMC[c][s]->Draw("colz");
if(c==1)
{
for(int st = 0; st < Nstrictnesses; st++)
{
uppergraph[0][s][st]->Draw("P");
lowergraph[0][s][st]->Draw("P");
}
}
}
}


// _____________________________________ //

TCanvas *can2 = new TCanvas("can2", "can2", 60, 60, 1000, 800);
can2->Divide(2, 2, 0.00001, 0.00001);

can2->cd(1);
hD[0][sector-1]->SetTitle(Form("E1F, negative tracks, sector %i", sector));
hD[0][sector-1]->Draw("colz");
can2->cd(2);
hD[1][sector-1]->SetTitle(Form("E1F, - tracks with other cuts, sector %i", sector));
hD[1][sector-1]->Draw("colz");
for(int st = 0; st < Nstrictnesses; st++)
{
uppergraph[1][sector-1][st]->Draw("P");
lowergraph[1][sector-1][st]->Draw("P");
}

can2->cd(3);
hMC[0][sector-1]->Draw("colz");
can2->cd(4);
hMC[1][sector-1]->Draw("colz");
for(int st = 0; st < Nstrictnesses; st++)
{
uppergraph[0][sector-1][st]->Draw("P");
lowergraph[0][sector-1][st]->Draw("P");
}

//can2->SaveAs(Form("CCthetaMatch_s%i.png", sector));

}
